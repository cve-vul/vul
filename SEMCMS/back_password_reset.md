# Background administrator password reset vulnerability

---
## vuln in /include/web_check.php
![a](https://upload-images.jianshu.io/upload_images/703764-605e3cc2ecb664f6.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

**In line 54 of the file, three variables are Judge whether it is empty; test_input and verify_str are keywords to detect whether the string has SQL and XSS. Let's ignore it here.**

**In line 60 of the file**
```
$query=$db_conn->query("select * from sc_user where user_email='".$umail."' and user_rzm='".$urzm."'");
```
**The validity of $umail and $urzm is verified by database queries.Moreover, $urzm is generated by the random number Rand (10,10000).**
![d](https://upload-images.jianshu.io/upload_images/703764-605e3cc2ecb664f6.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)
**And updated to the database in line 29**

![e](https://upload-images.jianshu.io/upload_images/703764-605e3cc2ecb664f6.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)
**Finally, the verification code is obtained by direct blasting with burp tool**
